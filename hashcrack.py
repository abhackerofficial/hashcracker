import hashlib, sys, os
from time import sleep
import time

program_name = sys.argv[0]

print ("""\33[49m                                                  \33[m
\33[49m                                                  \33[m
\33[49m                     \33[38;2;255;40;0;49m▄\33[38;2;255;39;0;48;2;254;44;6m▄\33[38;2;255;39;0;48;2;254;45;8m▄\33[38;2;255;39;0;48;2;254;46;9m▄\33[38;2;255;39;0;48;2;253;46;9m▄\33[38;2;255;39;0;48;2;254;45;8m▄\33[38;2;255;39;0;48;2;254;44;6m▄\33[38;2;255;40;0;49m▄\33[49m                     \33[m
\33[49m                   \33[38;2;255;54;16;49m▄\33[38;2;255;39;0;49m▄\33[38;2;255;39;0;48;2;255;38;0m▄\33[48;2;255;39;0m       \33[38;2;255;39;0;49m▄\33[38;2;248;81;50;49m▄\33[49m                   \33[m
\33[49m                  \33[38;2;255;39;0;48;2;248;41;4m▄\33[38;2;255;39;0;48;2;251;39;2m▄\33[48;2;255;39;0m          \33[38;2;255;39;0;48;2;252;39;2m▄\33[38;2;255;39;0;48;2;248;41;4m▄\33[49m                  \33[m
\33[49m                  \33[48;2;255;39;0m              \33[49m                  \33[m
\33[49m                \33[38;2;255;82;50;48;2;255;73;49m▄\33[38;2;255;39;0;48;2;255;69;34m▄\33[48;2;255;39;0m              \33[38;2;255;39;0;48;2;255;40;0m▄\33[38;2;255;38;0;48;2;255;39;0m▄\33[49m                \33[m
\33[49m                \33[38;2;255;87;55;48;2;255;84;54m▄\33[48;2;255;39;0m  \33[38;2;246;41;6;48;2;255;39;0m▄\33[49;38;2;255;39;0m▀\33[38;2;255;38;0;48;2;255;39;0m▄\33[48;2;255;39;0m       \33[49;38;2;255;39;0m▀\33[38;2;246;91;63;48;2;255;39;0m▄\33[48;2;255;39;0m  \33[38;2;255;39;0;48;2;255;37;0m▄\33[49m                \33[m
\33[49m                \33[38;2;255;84;54;48;2;255;87;55m▄\33[48;2;255;39;0m  \33[38;2;245;41;5;48;2;245;42;5m▄\33[49m \33[49;38;2;255;59;25m▀\33[48;2;255;39;0m      \33[49;38;2;255;59;24m▀\33[49m \33[38;2;245;86;57;48;2;245;90;60m▄\33[48;2;255;39;0m  \33[38;2;255;37;0;48;2;255;39;0m▄\33[49m                \33[m
\33[49m                \33[38;2;250;69;37;48;2;255;83;52m▄\33[38;2;246;41;6;48;2;255;39;0m▄▄\33[38;2;250;43;8;48;2;255;39;0m▄\33[48;2;255;39;0m          \33[38;2;249;48;13;48;2;255;39;0m▄\33[38;2;246;41;6;48;2;255;39;0m▄▄\33[38;2;246;43;4;48;2;255;38;0m▄\33[49m                \33[m
\33[49m                  \33[38;2;255;38;0;49m▄\33[38;2;255;38;0;48;2;255;37;0m▄\33[48;2;255;39;0m          \33[38;2;255;39;0;48;2;246;80;48m▄\33[38;2;255;38;0;49m▄\33[49m                  \33[m
\33[49m                \33[38;2;247;93;68;49m▄\33[38;2;244;83;51;49m▄\33[48;2;255;39;0m              \33[38;2;246;77;48;49m▄\33[38;2;250;74;42;49m▄\33[49m                \33[m
\33[49m              \33[38;2;255;39;0;49m▄▄\33[38;2;255;39;0;48;2;255;78;45m▄\33[48;2;255;39;0m                \33[38;2;255;39;0;48;2;255;40;0m▄\33[38;2;255;39;0;49m▄▄\33[49m              \33[m
\33[49m            \33[38;2;255;83;54;48;2;255;53;9m▄\33[38;2;255;39;0;48;2;255;54;17m▄\33[48;2;255;39;0m                      \33[38;2;255;39;0;48;2;255;54;17m▄\33[38;2;255;83;51;48;2;255;51;8m▄\33[49m            \33[m
\33[49m    \33[48;2;254;45;8m \33[48;2;255;39;0m \33[48;2;255;38;0m \33[49m \33[38;2;248;40;3;49m▄\33[38;2;255;38;0;48;2;251;75;46m▄\33[48;2;255;39;0m   \33[49;38;2;255;39;0m▀▀\33[38;2;254;37;0;48;2;255;39;0m▄\33[48;2;255;39;0m     \33[49;38;2;255;39;0m▀▀\33[49;38;2;248;74;42m▀\33[49m  \33[49;38;2;255;38;0m▀\33[49;38;2;255;39;0m▀▀\33[48;2;255;39;0m     \33[38;2;254;38;0;48;2;255;39;0m▄\33[49;38;2;255;39;0m▀▀\33[38;2;244;43;7;48;2;255;39;0m▄\33[48;2;255;39;0m  \33[38;2;255;38;0;48;2;246;72;40m▄\33[38;2;254;38;0;49m▄\33[49m \33[48;2;255;38;0m \33[48;2;255;39;0m \33[48;2;253;38;1m \33[49m    \33[m
\33[49m    \33[49;38;2;247;77;48m▀\33[38;2;255;40;0;48;2;248;77;44m▄\33[38;2;255;39;0;48;2;255;38;0m▄\33[38;2;255;39;0;48;2;246;83;50m▄\33[38;2;255;39;0;48;2;251;39;2m▄\33[38;2;252;52;15;48;2;253;51;15m▄\33[49;38;2;247;82;52m▀\33[49;38;2;248;77;46m▀\33[49;38;2;249;68;37m▀\33[49m \33[38;2;255;39;0;48;2;247;77;45m▄\33[38;2;255;39;0;48;2;255;38;0m▄\33[48;2;255;39;0m     \33[49m        \33[48;2;255;39;0m     \33[38;2;255;39;0;48;2;255;38;0m▄\33[38;2;255;39;0;48;2;246;86;54m▄\33[49m \33[49;38;2;241;71;40m▀\33[49;38;2;248;77;46m▀\33[49;38;2;247;82;52m▀\33[38;2;254;53;15;48;2;252;54;19m▄\33[38;2;255;39;0;48;2;255;38;0m▄\33[38;2;255;39;0;48;2;249;75;43m▄\33[38;2;255;39;0;48;2;255;38;0m▄\33[38;2;255;117;92;48;2;250;91;62m▄\33[49;38;2;247;78;47m▀\33[49m    \33[m
\33[49m       \33[38;2;255;39;0;49m▄▄\33[38;2;253;50;12;49m▄\33[49m  \33[38;2;255;44;7;49m▄\33[38;2;255;61;26;49m▄\33[48;2;255;39;0m \33[38;2;255;40;0;48;2;255;39;0m▄\33[38;2;255;55;19;48;2;255;39;0m▄\33[48;2;255;39;0m  \33[38;2;245;42;5;48;2;245;41;5m▄\33[49m          \33[38;2;245;88;58;48;2;246;86;56m▄\33[48;2;255;39;0m  \33[38;2;255;38;0;48;2;255;39;0m▄\33[38;2;255;40;0;48;2;255;39;0m▄\33[48;2;255;39;0m \33[38;2;255;54;19;49m▄\33[38;2;255;36;0;49m▄\33[49m  \33[38;2;255;46;8;49m▄\33[38;2;255;45;5;49m▄\33[38;2;255;43;5;49m▄\33[49m       \33[m
\33[49m     \33[38;2;255;40;0;49m▄\33[38;2;255;39;0;49m▄\33[48;2;255;39;0m  \33[48;2;252;50;13m \33[49m  \33[38;2;255;62;29;48;2;255;40;0m▄\33[48;2;255;39;0m  \33[49m \33[48;2;255;86;56m \33[48;2;255;39;0m  \33[38;2;246;41;6;48;2;246;42;5m▄\33[49m          \33[38;2;244;89;61;48;2;245;88;59m▄\33[48;2;255;39;0m  \33[38;2;255;39;0;48;2;255;38;0m▄\33[49m \33[48;2;255;39;0m  \33[38;2;255;61;25;48;2;255;40;0m▄\33[49m  \33[48;2;255;49;12m \33[48;2;255;39;0m  \33[38;2;255;39;0;49m▄\33[38;2;255;80;48;49m▄\33[49m     \33[m
\33[49m     \33[48;2;255;40;0m \33[48;2;255;38;0m \33[38;2;246;41;7;49m▄\33[49m \33[38;2;241;71;43;49m▄\33[38;2;244;42;5;49m▄\33[38;2;255;39;1;48;2;255;41;1m▄\33[48;2;255;39;0m  \33[49m  \33[38;2;255;84;54;48;2;255;87;57m▄\33[48;2;255;39;0m  \33[38;2;251;40;3;48;2;246;41;6m▄\33[38;2;244;42;5;49m▄\33[49m        \33[38;2;245;41;6;49m▄\33[38;2;248;49;13;48;2;246;92;63m▄\33[48;2;255;39;0m  \33[38;2;255;38;0;48;2;255;39;0m▄\33[49m  \33[48;2;255;39;0m   \33[38;2;246;42;5;49m▄\33[38;2;242;72;42;49m▄\33[49m \33[38;2;246;42;5;49m▄\33[48;2;255;38;0m \33[48;2;255;90;60m \33[49m     \33[m
\33[49m     \33[48;2;255;40;0m \33[48;2;255;39;0m  \33[38;2;255;39;0;49m▄\33[38;2;255;39;0;48;2;255;67;33m▄\33[48;2;255;39;0m \33[49;38;2;255;40;1m▀\33[49;38;2;255;39;0m▀▀\33[49m  \33[49;38;2;255;79;48m▀\33[49;38;2;255;40;1m▀\33[48;2;255;39;0m \33[38;2;244;41;6;48;2;255;39;0m▄\33[49;38;2;255;39;0m▀\33[49m        \33[49;38;2;255;39;0m▀\33[38;2;246;93;63;48;2;255;40;1m▄\33[48;2;255;39;0m \33[49;38;2;255;40;1m▀\33[49;38;2;255;39;0m▀\33[49m  \33[49;38;2;255;39;0m▀▀\33[49;38;2;255;40;1m▀\33[48;2;255;39;0m \33[38;2;255;39;0;48;2;249;72;39m▄\33[38;2;255;39;0;49m▄\33[48;2;255;39;0m  \33[38;2;255;39;0;48;2;255;51;13m▄\33[49m     \33[m
\33[49m      \33[49;38;2;249;73;41m▀\33[49;38;2;247;74;43m▀▀▀\33[49;38;2;249;72;39m▀\33[49m       \33[48;2;255;39;0m \33[38;2;255;38;0;48;2;253;45;8m▄\33[38;2;255;38;0;48;2;252;54;17m▄\33[49m        \33[38;2;255;38;0;48;2;254;51;14m▄\33[38;2;255;38;0;48;2;252;55;20m▄\33[48;2;255;39;0m \33[49m       \33[49;38;2;252;72;37m▀\33[49;38;2;246;74;40m▀\33[49;38;2;247;74;43m▀▀\33[49;38;2;249;73;41m▀\33[49m      \33[m
\33[49m              \33[38;2;255;38;0;49m▄▄\33[38;2;255;58;24;49m▄\33[49m \33[48;2;255;39;0m \33[38;2;255;38;0;48;2;246;41;6m▄\33[38;2;254;38;0;49m▄\33[49m        \33[38;2;254;38;0;49m▄\33[38;2;255;38;0;48;2;246;87;56m▄\33[48;2;255;39;0m \33[49m \33[38;2;255;46;11;49m▄\33[38;2;255;38;0;49m▄▄\33[49m              \33[m
\33[49m              \33[49;38;2;255;117;92m▀\33[38;2;253;39;1;48;2;255;38;0m▄\33[38;2;253;42;4;48;2;255;42;3m▄\33[38;2;254;43;6;48;2;255;39;0m▄\33[38;2;253;42;4;48;2;255;39;0m▄\33[38;2;243;42;7;48;2;247;52;17m▄\33[49;38;2;255;93;64m▀\33[49m        \33[49;38;2;255;72;39m▀\33[38;2;247;82;52;48;2;248;85;55m▄\33[38;2;254;42;3;48;2;255;39;0m▄\33[38;2;254;42;5;48;2;255;39;0m▄\33[38;2;254;43;6;48;2;255;41;2m▄\33[38;2;253;41;3;48;2;255;38;0m▄\33[49;38;2;255;114;88m▀\33[49m              \33[m
\33[49m                                                  \33[m
\33[49m                                                  \33[m
""")

if len(sys.argv) < 4:
    print(f"""    Usage of {program_name} :
{program_name} <hash-value> <hash-type> <path-to-password-file>

         Example of usage :
{program_name} 5d41402abc4b2a76b9719d911017c592 md5 passwd_list.txt""")
    exit()

hash_value = sys.argv[1]
hash_type = sys.argv[2]
passwd_file = sys.argv[3]

count=1

# Open the password file for reading

if not os.path.exists(passwd_file):
    print(f"Password file '{passwd_file}' not found.")
    exit()

with open(passwd_file, "r", encoding='latin-1') as file:
    # Read the list of passwords
    passwords = file.readlines()

    # Loop through the list of passwords
    for password in passwords:
        # Strip the newline character from each password
        password = password.strip()
        count += 1
        start = time.time()
        # Generate the MD5 hash of the password

        if hash_type == "md5":
            password_hash=hashlib.md5(f"{password}".encode('utf-8')).hexdigest()
        elif hash_type == "sha1":
            password_hash=hashlib.sha1(f"{password}".encode('utf-8')).hexdigest()
        elif hash_type == "sha224":
            password_hash=hashlib.sha224(f"{password}".encode('utf-8')).hexdigest()
        elif hash_type == "sha256":
            password_hash=hashlib.sha256(f"{password}".encode('utf-8')).hexdigest()
        elif hash_type == "sha512":
            password_hash=hashlib.sha512(f"{password}".encode('utf-8')).hexdigest()
        else:
            print("Unidentified hash type has selected.")
            exit()

        # Compare the hash to the hash entered by the user
        if password_hash == hash_value:
            end = time.time()
            total_time = (end - start)
            print(f"\33[92mPassword found: {password}\33[0m")
            print(f"Total time consumed: {total_time}")
            break
        else:
            print(f"\33[91m{count}. No match found: {password}\33[0m ")
            sleep(0.000100)          # wait a little to make the effect look good.

